<!--
  Tab 3: Update / Delete
  Author: Stephen Travers 23885594
  Description: Find, edit and delete inventory items.
-->

<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Update / Delete</ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="showHelpAlert()">
        HELP
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <!-- Find item -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Find item</ion-card-title>
    </ion-card-header>
    <ion-card-content>

      <!-- Name to search -->
      <ion-item>
        <ion-label position="floating">Item name</ion-label>
        <ion-input [(ngModel)]="searchName"></ion-input>
      </ion-item>

      <!-- Search button -->
      <ion-button
        expand="block"
        color="primary"
        shape="round"
        (click)="onSearch()">
        Search
      </ion-button>

      <!-- Message for search + final update result -->
      <p [style.color]="formIsError ? 'red' : 'green'">
        {{ formMessage }}
      </p>
    </ion-card-content>
  </ion-card>

  <!-- Edit item section (only if item found) -->
  <ion-card *ngIf="currentItem.length">
    <ion-card-header>
      <ion-card-title>Edit item</ion-card-title>
    </ion-card-header>
    <ion-card-content>

      <!-- Category -->
      <ion-item class="select-row">
        <ion-select
          label="Category"
          labelPlacement="stacked"
          interface="popover"
          fill="outline"
          placeholder="Tap to choose category"
          [(ngModel)]="currentItem[0].category">
          <ion-select-option value="Electronics">Electronics</ion-select-option>
          <ion-select-option value="Furniture">Furniture</ion-select-option>
          <ion-select-option value="Clothing">Clothing</ion-select-option>
          <ion-select-option value="Tools">Tools</ion-select-option>
          <ion-select-option value="Miscellaneous">Miscellaneous</ion-select-option>
        </ion-select>
      </ion-item>

      <!-- Quantity -->
      <ion-item>
        <ion-label position="floating">Quantity</ion-label>
        <ion-input type="number" [(ngModel)]="currentItem[0].quantity"></ion-input>
      </ion-item>

      <!-- Price -->
      <ion-item>
        <ion-label position="floating">Price ($)</ion-label>
        <ion-input type="number" [(ngModel)]="currentItem[0].price"></ion-input>
      </ion-item>

      <!-- Supplier -->
      <ion-item>
        <ion-label position="floating">Supplier</ion-label>
        <ion-input [(ngModel)]="currentItem[0].supplier_name"></ion-input>
      </ion-item>

      <!-- Stock status -->
      <ion-item class="select-row">
        <ion-select
          label="Stock status"
          labelPlacement="stacked"
          interface="popover"
          fill="outline"
          placeholder="Tap to choose status"
          [(ngModel)]="currentItem[0].stock_status">
          <ion-select-option value="In stock">In stock</ion-select-option>
          <ion-select-option value="Low stock">Low stock</ion-select-option>
          <ion-select-option value="Out of stock">Out of stock</ion-select-option>
        </ion-select>
      </ion-item>

      <!-- Featured (Yes/No) -->
      <ion-item class="select-row">
        <ion-select
          label="Featured"
          labelPlacement="stacked"
          interface="popover"
          fill="outline"
          placeholder="Tap to choose"
          [(ngModel)]="currentItem[0].featured_item">
          <ion-select-option [value]="1">Yes</ion-select-option>
          <ion-select-option [value]="0">No</ion-select-option>
        </ion-select>
      </ion-item>

      <!-- Special note -->
      <ion-item>
        <ion-label position="floating">Special note</ion-label>
        <ion-textarea [(ngModel)]="currentItem[0].special_note"></ion-textarea>
      </ion-item>

      <!-- Save button -->
      <ion-button
        expand="block"
        color="success"
        shape="round"
        (click)="onUpdate()">
        Save changes
      </ion-button>

      <!-- Update validation -->
      <p [style.color]="updateIsError ? 'red' : 'green'">
        {{ updateMessage }}
      </p>
    </ion-card-content>
  </ion-card>

  <!-- Delete item -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Delete item</ion-card-title>
    </ion-card-header>
    <ion-card-content>

      <ion-item>
        <ion-label position="floating">Name to delete</ion-label>
        <ion-input [(ngModel)]="deleteName"></ion-input>
      </ion-item>

      <ion-button
        expand="block"
        color="danger"
        shape="round"
        (click)="onDelete()">
        Delete item
      </ion-button>

      <p [style.color]="deleteIsError ? 'red' : 'green'">
        {{ deleteMessage }}
      </p>
    </ion-card-content>
  </ion-card>

</ion-content>
